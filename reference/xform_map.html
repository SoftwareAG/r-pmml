<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Implement a map between discrete values in accordance with the PMML element
MapValues. — xform_map • pmml</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Implement a map between discrete values in accordance with the PMML element
MapValues. — xform_map" />
<meta property="og:description" content="Implement a map between discrete values in accordance with the PMML element
MapValues." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/packages_and_functions.html">Supported Packages and Additional Functions</a>
    </li>
    <li>
      <a href="../articles/xform_function.html">Introduction to xform_function</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SoftwareAG/r-pmml/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Implement a map between discrete values in accordance with the PMML element
<b>MapValues</b>.</h1>
    <small class="dont-index">Source: <a href='https://github.com/SoftwareAG/r-pmml/blob/master/R/xform_map.R'><code>R/xform_map.R</code></a></small>
    <div class="hidden name"><code>xform_map.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implement a map between discrete values in accordance with the PMML element
<b>MapValues</b>.</p>
    </div>

    <pre class="usage"><span class='fu'>xform_map</span><span class='op'>(</span>
  <span class='va'>wrap_object</span>,
  <span class='va'>xform_info</span>,
  table <span class='op'>=</span> <span class='cn'>NA</span>,
  default_value <span class='op'>=</span> <span class='cn'>NA</span>,
  map_missing_to <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>wrap_object</th>
      <td><p>Output of xform_wrap or another transformation function.</p></td>
    </tr>
    <tr>
      <th>xform_info</th>
      <td><p>Specification of details of the transformation. It can be a
text giving the external file name or a list of data frames. Even if only 1
variable is to be transformed, the information for that map should be given
as a list with 1 element.</p></td>
    </tr>
    <tr>
      <th>table</th>
      <td><p>Name of external CSV file containing the map from input to
output values.</p></td>
    </tr>
    <tr>
      <th>default_value</th>
      <td><p>The default value to be given to the transformed
variable. If 'xform_info' is a list, this is a vector with each element
corresponding to the corresponding list element.</p></td>
    </tr>
    <tr>
      <th>map_missing_to</th>
      <td><p>Value to be given to the transformed variable if the
value of the input variable is missing.  If 'xform_info' is a list, this is a
vector with each element corresponding to the corresponding list element.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to or from other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>R object containing the raw data, the transformed data and data
statistics.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Map discrete values of an input variable to a discrete value of the
transformed variable. The map can be given in an external table file
referred to in the transform command or as a list of data frames, each data
frame defining a map transform for one variable.</p>
<p>Given a map from the combination of variables <b>InVar1</b>, <b>InVar2</b>,
... to the transformed variable <b>OutVar</b>, where the variables have the
data types <b>InType1</b>, <b>InType2</b>, ... and <b>OutType</b>, the map
command is in the format:</p>
<pre>
xform_info = "[InVar1,InVar2,... -&gt; OutVar][InType1,InType2,... -&gt; OutType]"
table = "TableFileName", default_value = "defVal", map_missing_to = "missingVal"
</pre>

<p>where <b>TableFileName</b> is the name of the CSV file containing the map.
The map can be a N to 1 map where N is greater or equal to 1. The data types
of the variables can be any of the ones defined in the PMML format including
integer, double or string. <b>defVal</b> is the default value of the
transformed variable and if any of the map input values are missing,
<b>missingVal</b> is the value of the transformed variable.</p>
<p>The arguments InType, OutType, default_value and map_missing_to are optional.
The CSV file containing the table should not have any row and column
identifiers, and the values given must be in the same order as in the map
command. If the data types of the variables are not given, the data types of
the input variables are attempted to be determined from the <b>boxData</b>
argument.  If that is not possible, the data type is assumed to be string.</p>
<p>It is also possible to give the maps to be implemented without an external
file using a list of data frames. Each data frame defines a map for 1 input
variable. Given a data frame with N+1 columns, it is assumed that the map is
a N to 1 map where the last column of the data frame corresponds to the
derived field. The 1st row is assumed to be the names of the fields and the
second row the data types of the fields. The rest of the rows define the
map; each combination of the input values in a row is mapped to the value in
the last column of that row. The second row with the data types of the
fields is not required. If not given, all fields are assumed to be strings.
In this input format, the 'default_value' and 'map_missing_to' parameters
should be vectors. The first element of each vector will correspond to the
derived field defined in the 1st element of the 'xform_info' list etc. These
are made clearer in the example below.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='xform_wrap.html'>xform_wrap</a></code>, <code><a href='pmml.html'>pmml</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Tridivesh Jena</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load the standard audit dataset, part of the pmml package:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>audit</span><span class='op'>)</span>

<span class='co'># First wrap the data:</span>
<span class='va'>audit_box</span> <span class='op'>&lt;-</span> <span class='fu'><a href='xform_wrap.html'>xform_wrap</a></span><span class='op'>(</span><span class='va'>audit</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># One of the variables, "Sex", has 2 possible values: "Male"</span>
<span class='co'># and "Female". If these string values have to be mapped to a</span>
<span class='co'># numeric value, a file has to be created, say "map_audit.csv",</span>
<span class='co'># whose content is, for example:</span>
<span class='co'>#</span>
<span class='co'>#  Male,1</span>
<span class='co'>#  Female,2</span>
<span class='co'>#</span>
<span class='co'># Transform the variable "Gender" to a variable "d_gender"</span>
<span class='co'># such that:</span>
<span class='co'>#    if Sex = "Male" then d_sex = "1"</span>
<span class='co'>#    if Sex = "Female" then d_sex = "2"</span>
<span class='co'>#</span>
<span class='co'># Give "d_sex" the value 0 if the input variable value is</span>
<span class='co'># missing.</span>
<span class='va'>audit_box</span> <span class='op'>&lt;-</span> <span class='fu'>xform_map</span><span class='op'>(</span><span class='va'>audit_box</span>,
  xform_info <span class='op'>=</span> <span class='st'>"[Sex -&gt; d_sex][string-&gt;integer]"</span>,
  table <span class='op'>=</span> <span class='st'>"map_audit.csv"</span>, map_missing_to <span class='op'>=</span> <span class='st'>"0"</span>
<span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Same as above, with an extra variable, but using data frames.</span>
<span class='co'># The top 2 rows give the variable names and their data types.</span>
<span class='co'># The rest represent the map. For example, the third row</span>
<span class='co'># indicates that when the input variable "Sex" has the value</span>
<span class='co'># "Male" and the input variable "Employment" has</span>
<span class='co'># the value "PSLocal", the output variable "d_sex" should have</span>
<span class='co'># the value 1.</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sex"</span>, <span class='st'>"string"</span>, <span class='st'>"Male"</span>, <span class='st'>"Female"</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Employment"</span>, <span class='st'>"string"</span>, <span class='st'>"PSLocal"</span>, <span class='st'>"PSState"</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"d_sex"</span>, <span class='st'>"integer"</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,
  stringsAsFactors <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
<span class='va'>t</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>m</span>

<span class='co'># Give default value as a vector and missing value as a string,</span>
<span class='co'># this is only possible as there is only one map defined. If</span>
<span class='co'># default values is not given, it will simply not be given in</span>
<span class='co'># the PMML file as well. In general, the default values and the</span>
<span class='co'># missing values should be given as a vector, each element of</span>
<span class='co'># the vector corresponding to the element at the same index in</span>
<span class='co'># the list. If these values are not given as a vector, they will</span>
<span class='co'># be used for the first list element only.</span>
<span class='va'>audit_box</span> <span class='op'>&lt;-</span> <span class='fu'>xform_map</span><span class='op'>(</span><span class='va'>audit_box</span>,
  xform_info <span class='op'>=</span> <span class='va'>t</span>, default_value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>,
  map_missing_to <span class='op'>=</span> <span class='st'>"2"</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in `[.data.frame`(newBoxData$data, , orig[1, i]): undefined columns selected</span></div><div class='input'>
<span class='co'># check what the pmml looks like</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Adjusted</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>audit_box</span><span class='op'>$</span><span class='va'>data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in eval(predvars, data, env): object 'Adjusted' not found</span></div><div class='input'><span class='va'>fit_pmml</span> <span class='op'>&lt;-</span> <span class='fu'><a href='pmml.html'>pmml</a></span><span class='op'>(</span><span class='va'>fit</span>, transforms <span class='op'>=</span> <span class='va'>audit_box</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in pmml(fit, transforms = audit_box): object 'fit' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dmitriy Bolotov, Tridivesh Jena, Graham Williams, Wen-Ching Lin, Michael Hahsler, Hemant Ishwaran, Udaya B. Kogalur, Rajarshi Guha.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


